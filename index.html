<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>First Aid Map</title>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: 'Roboto', sans-serif; 
            display: flex; 
            height: 100vh; 
            background-color: #f4f4f4;
        }
        #map { 
            flex: 1; 
            position: relative; 
        }
        #info-panel {
            width: 300px; 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            position: absolute; 
            right: 10px; 
            top: 10px; 
            z-index: 10; 
            display: none; 
        }
        h2 {
            font-size: 24px; 
            margin-bottom: 10px; 
        }
        p {
            margin: 0 0 10px; 
            font-size: 14px; 
            line-height: 1.5; 
        }
        a {
            color: #0070f3; 
            text-decoration: none; 
        }
        button {
            background-color: #0070f3; 
            color: white;
            border: none;
            border-radius: 5px; 
            padding: 10px 15px;
            cursor: pointer;
            margin-top: 10px; 
        }
        button:hover {
            background-color: #005bb5; 
        }
    </style>
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
</head>
<body>
    <div id="map" role="application" aria-label="Map displaying first aid locations"></div>
    <div id="info-panel" role="dialog" aria-labelledby="info-panel-title" aria-hidden="true">
        <h2 id="info-panel-title">First Aid Information</h2>
        <p id="building-name"></p>
        <p id="building-address"></p>
        <div id="building-url"></div>
        <button id="close-panel" aria-label="Close information panel">Close</button>
    </div>
    <script>
        const MAPBOX_ACCESS_TOKEN = 'pk.eyJ1IjoiZWhzIiwiYSI6ImNtMjNsYWtlZzA2bnQycW9qb2F3dHJuM2gifQ.Yw2JtBD13UqJFKtTj-SKsQ'; // Replace with your public access token

        mapboxgl.accessToken = MAPBOX_ACCESS_TOKEN;

        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/light-v11', 
            center: [-79.3832, 43.6532], 
            zoom: 12
        });

        // Load GeoJSON data
        map.on('load', () => {
            map.addSource('first-aid-source', {
                type: 'geojson',
                data: 'https://raw.githubusercontent.com/ehs-uoft/FA/refs/heads/main/geojson.geojson',
            });

            map.addLayer({
                id: 'first-aid-points',
                type: 'symbol',
                source: 'first-aid-source',
                layout: {
                    'icon-image': 'https://github.com/ehs-uoft/FA/raw/80b08d35ae684f78b0fd2f602cf8693f3e572c91/HH-4_First_Aid_Symbol_large.png',
                    'icon-size': 0.1,
                    'icon-allow-overlap': true
                }
            });

            map.on('click', 'first-aid-points', (e) => {
                const properties = e.features[0].properties;

                // Update info panel content
                document.getElementById('building-name').innerText = properties.name;
                document.getElementById('building-address').innerText = properties.address;
                document.getElementById('building-url').innerHTML = properties.url;

                // Show the info panel
                document.getElementById('info-panel').style.display = 'block';
                document.getElementById('info-panel').setAttribute('aria-hidden', 'false');
            });

            // Close panel button event
            document.getElementById('close-panel').onclick = function() {
                document.getElementById('info-panel').style.display = 'none';
                document.getElementById('info-panel').setAttribute('aria-hidden', 'true');
            };

            // Zoom controls
            const nav = new mapboxgl.NavigationControl();
            map.addControl(nav, 'top-right');
        });
    </script>
</body>
</html>
